<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dominic Sander">

<title>Lab: List Processing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap-8a79a254b8e706d3c925cde0a310d4f0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab: List Processing</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dominic Sander </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>You can see the purpose of this assignment as well as the skills and knowledge you should be using and acquiring, in the <a href="tilt.qmd">Transparency in Learning and Teaching (TILT)</a> document in this repository. The TILT document also contains a checklist for self-reflection that will provide some guidance on how the assignment will be graded.</p>
</div>
</div>
</div>
<section id="data-source" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Data Source</h1>
<p>JSON data files for this assignment were obtained from the TVMaze API for three different Doctor Who series as well as two different spin-offs.</p>
<ul>
<li>Dr.&nbsp;Who <a href="https://www.tvmaze.com/shows/72724/doctor-who">2023-2025</a></li>
<li>Dr.&nbsp;Who <a href="https://www.tvmaze.com/shows/210/doctor-who">2005-2022</a></li>
<li>Dr.&nbsp;Who <a href="https://www.tvmaze.com/shows/766/doctor-who">1963-1996</a></li>
<li><a href="https://www.tvmaze.com/shows/970/the-sarah-jane-adventures">The Sarah Jane Adventures (2007-2020)</a></li>
<li><a href="https://www.tvmaze.com/shows/659/torchwood">Torchwood (2006-2011)</a></li>
<li><a href="https://www.tvmaze.com/shows/26694/torchwood-web-of-lies">Torchwood: Web of Lies (2011)</a></li>
</ul>
</section>
<section id="warming-up" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Warming Up</h1>
<p>For this portion of the assignment, only work with the canonical Dr.&nbsp;Who files (drwho2023.json, drwho2005.json, drwho1963.json).</p>
<section id="parse-the-file" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="parse-the-file"><span class="header-section-number">2.1</span> Parse the file</h2>
<p>Add a code chunk that will read each of the JSON files in. Store the data in a <code>drwhoYYYY</code> object, where <code>YYYY</code> is the first year the series began to air. How are the data objects stored?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xml2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ readr     2.1.5
✔ ggplot2   3.5.2     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'jsonlite'

The following object is masked from 'package:purrr':

    flatten</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'janitor'

The following objects are masked from 'package:stats':

    chisq.test, fisher.test</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbreak)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ggbreak v0.1.6 Learn more at https://yulab-smu.top/


If you use ggbreak in published research, please cite the following
paper:

S Xu, M Chen, T Feng, L Zhan, L Zhou, G Yu. Use ggbreak to effectively
utilize plotting space to deal with large datasets and outliers.
Frontiers in Genetics. 2021, 12:774846. doi: 10.3389/fgene.2021.774846</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>drwho2005 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"drwho-210.json"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>drwho1963 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"drwho-766.json"</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>drwho2023 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"drwho-72724.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The data objects are all stored as lists.</p>
</section>
<section id="examining-list-data-structures" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="examining-list-data-structures"><span class="header-section-number">2.2</span> Examining List Data Structures</h2>
<p>Create a nested markdown list showing what variables are nested at each level of the JSON file. Include an ‘episode’ object that is a stand-in for a generic episode (e.g.&nbsp;don’t create a list with all 700+ episodes in it, just show what a single episode has). Make sure you use proper markdown formatting to ensure that the lists are rendered properly when you compile your document.</p>
<p>Hint: The <code>prettify()</code> function in the R package <code>jsonlite</code> will spit out a better-formatted version of a JSON file.</p>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(drwho1963)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "id"       "url"      "name"     "season"   "number"   "type"    
 [7] "airdate"  "airtime"  "airstamp" "runtime"  "rating"   "image"   
[13] "summary"  "_links"  </code></pre>
</div>
</div>
<ul>
<li><p>ID</p></li>
<li><p>URL</p></li>
<li><p>Name</p></li>
<li><p>Season</p></li>
<li><p>Number</p></li>
<li><p>Type</p></li>
<li><p>Air date</p></li>
<li><p>Air time</p></li>
<li><p>Air stamp</p></li>
<li><p>Runtime</p></li>
<li><p>Rating (actual rating is nested)</p></li>
<li><p>Image</p></li>
<li><p>Summary</p></li>
<li><p>Links (self and show(with link and name in show))</p></li>
</ul>
<hr>
<p>Is there any information stored in the list structure that you feel is redundant? If so, why?</p>
<p>I think airdate, airtime, and airstamp tell us the same things, so we can remove airtime and airdate. Airstamp gives us the date and time of the episode first airing which is the same thing as airdate and airtime combined. The image item also has two links to images which doesn’t seem necessary.</p>
</section>
<section id="develop-a-strategy" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="develop-a-strategy"><span class="header-section-number">2.3</span> Develop A Strategy</h2>
<p>Consider what information you would need to examine the structure of Dr.&nbsp;Who episodes over time (show runtime, season length, specials) as well as the ratings, combining information across all three data files.</p>
<p>Sketch one or more rectangular data tables that look like your expected output. Remember that if you link to an image, you must link to something with a picture extension (<code>.png</code>, <code>.jpg</code>), and if you reference a file it should be using a local path and you must also add the picture to your git repository.</p>
<hr>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IMG_2341.jpg" class="img-fluid figure-img"></p>
<figcaption>A picture of my rough sketch of the final data tables.</figcaption>
</figure>
</div>
<hr>
<p>What operations will you need to perform to get the data into a form matching your sketch? Make an ordered list of steps you need to take.</p>
<hr>
<ol type="1">
<li>I would try to convert each data set into one large rectangular data set using fromJSON</li>
<li>I’d then create a new column in each with a key for which show it actually is.</li>
<li>I’d join the data sets into one large data set with everything to make sure nothing is formatted incorrectly.</li>
<li>I’d then select columns to columns to create the data sets I created above. All will include the ID column because it can be used as a key.</li>
<li>I would then need to make sure all columns are named correctly</li>
<li>I’d also need to make sure the columns have the right class.</li>
</ol>
</section>
<section id="implement-your-strategy" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="implement-your-strategy"><span class="header-section-number">2.4</span> Implement Your Strategy</h2>
<p>Add a code chunk that will convert the JSON files into the table(s) you sketched above. Make sure that the resulting tables have the correct variable types (e.g., dates should not be stored as character variables).</p>
<p>Print out the first 5 rows of each table that you create (but no more)!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>drwho2005 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"drwho-210.json"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">showid =</span> <span class="dv">2</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>drwho1963 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"drwho-766.json"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">showid =</span> <span class="dv">1</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>drwho2023 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"drwho-72724.json"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">showid =</span> <span class="dv">3</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>canon_dr <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(drwho1963, drwho2005, drwho2023) <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_names</span>()</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>canon_dr <span class="ot">&lt;-</span> canon_dr <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest_wider</span>(image, <span class="at">names_sep =</span> <span class="st">"_"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest_wider</span>(rating, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest_wider</span>(links, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest_wider</span>(links_self, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest_wider</span>(links_show, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">airdate =</span> <span class="fu">as_date</span>(airdate)) <span class="sc">%&gt;%</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">airtime =</span> <span class="fu">hms</span>(airtime)) <span class="sc">%&gt;%</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">airstamp =</span> <span class="fu">as_datetime</span>(airstamp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `airtime = hms(airtime)`.
Caused by warning in `.parse_hms()`:
! Some strings failed to parse</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(canon_dr, class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$id
[1] "integer"

$url
[1] "character"

$name
[1] "character"

$season
[1] "integer"

$number
[1] "integer"

$type
[1] "character"

$airdate
[1] "Date"

$airtime
[1] "Period"
attr(,"package")
[1] "lubridate"

$airstamp
[1] "POSIXct" "POSIXt" 

$runtime
[1] "integer"

$rating_average
[1] "numeric"

$image_medium
[1] "character"

$image_original
[1] "character"

$summary
[1] "character"

$links_self_href
[1] "character"

$links_show_href
[1] "character"

$links_show_name
[1] "character"

$showid
[1] "numeric"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>episode_info <span class="ot">&lt;-</span> canon_dr <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, showid, name, season, number, rating_average, type)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(episode_info)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
     id showid name                           season number rating_average type 
  &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;                           &lt;int&gt;  &lt;int&gt;          &lt;dbl&gt; &lt;chr&gt;
1 67360      1 An Unearthly Child (An Uneart…      1      1            8.1 regu…
2 67361      1 The Cave of Skulls (An Uneart…      1      2            7.2 regu…
3 67362      1 The Forest of Fear (An Uneart…      1      3            7.1 regu…
4 67363      1 The Firemaker (An Unearthly C…      1      4            7.4 regu…
5 67364      1 The Dead Planet (The Daleks, …      1      5            7.6 regu…
6 67365      1 The Survivors (The Daleks, Pa…      1      6            7.7 regu…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(episode_info)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
       id showid name                         season number rating_average type 
    &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;                         &lt;int&gt;  &lt;int&gt;          &lt;dbl&gt; &lt;chr&gt;
1 3207275      3 The Well                          2      3            7.7 regu…
2 3207276      3 Lucky Day                         2      4            7.5 regu…
3 3207277      3 The Story &amp; the Engine            2      5            7.5 regu…
4 3207278      3 The Interstellar Song Conte…      2      6            8.3 regu…
5 3207280      3 Wish World                        2      7            8   regu…
6 3207281      3 The Reality War                   2      8            7.8 regu…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>episode_timing <span class="ot">&lt;-</span> canon_dr <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, showid, airstamp, runtime, season, number)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(episode_info)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
     id showid name                           season number rating_average type 
  &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;                           &lt;int&gt;  &lt;int&gt;          &lt;dbl&gt; &lt;chr&gt;
1 67360      1 An Unearthly Child (An Uneart…      1      1            8.1 regu…
2 67361      1 The Cave of Skulls (An Uneart…      1      2            7.2 regu…
3 67362      1 The Forest of Fear (An Uneart…      1      3            7.1 regu…
4 67363      1 The Firemaker (An Unearthly C…      1      4            7.4 regu…
5 67364      1 The Dead Planet (The Daleks, …      1      5            7.6 regu…
6 67365      1 The Survivors (The Daleks, Pa…      1      6            7.7 regu…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(episode_info)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
       id showid name                         season number rating_average type 
    &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;                         &lt;int&gt;  &lt;int&gt;          &lt;dbl&gt; &lt;chr&gt;
1 3207275      3 The Well                          2      3            7.7 regu…
2 3207276      3 Lucky Day                         2      4            7.5 regu…
3 3207277      3 The Story &amp; the Engine            2      5            7.5 regu…
4 3207278      3 The Interstellar Song Conte…      2      6            8.3 regu…
5 3207280      3 Wish World                        2      7            8   regu…
6 3207281      3 The Reality War                   2      8            7.8 regu…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>episode_additional <span class="ot">&lt;-</span> canon_dr <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, showid, image_original, summary, url)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(episode_additional)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
     id showid image_original                                      summary url  
  &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;                                               &lt;chr&gt;   &lt;chr&gt;
1 67360      1 https://static.tvmaze.com/uploads/images/original_… "&lt;p&gt;Ba… http…
2 67361      1 https://static.tvmaze.com/uploads/images/original_… "&lt;p&gt;Ba… http…
3 67362      1 https://static.tvmaze.com/uploads/images/original_… "&lt;p&gt;Ba… http…
4 67363      1 https://static.tvmaze.com/uploads/images/original_… "&lt;p&gt;Ba… http…
5 67364      1 https://static.tvmaze.com/uploads/images/original_… "&lt;p&gt;Th… http…
6 67365      1 https://static.tvmaze.com/uploads/images/original_… "&lt;p&gt;Th… http…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(episode_additional)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
       id showid image_original                                    summary url  
    &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;                                             &lt;chr&gt;   &lt;chr&gt;
1 3207275      3 https://static.tvmaze.com/uploads/images/origina… &lt;p&gt;Far… http…
2 3207276      3 https://static.tvmaze.com/uploads/images/origina… &lt;p&gt;Rub… http…
3 3207277      3 https://static.tvmaze.com/uploads/images/origina… &lt;p&gt;In … http…
4 3207278      3 https://static.tvmaze.com/uploads/images/origina… &lt;p&gt;The… http…
5 3207280      3 https://static.tvmaze.com/uploads/images/origina… &lt;p&gt;Tra… http…
6 3207281      3 https://static.tvmaze.com/uploads/images/origina… &lt;p&gt;Bat… http…</code></pre>
</div>
</div>
</section>
<section id="examining-episode-air-dates" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="examining-episode-air-dates"><span class="header-section-number">2.5</span> Examining Episode Air Dates</h2>
<p>Visually represent the length of time between air dates of adjacent episodes within the same season, across all seasons of Dr.&nbsp;Who. You may need to create a factor to indicate which Dr.&nbsp;Who series is indicated, as there will be a Season 1 for each of the series. Your plot must have appropriate labels and a title.</p>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>episode_timing<span class="sc">$</span>airstamp <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(episode_timing<span class="sc">$</span>airstamp)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>time_diff <span class="ot">&lt;-</span> episode_timing <span class="sc">%&gt;%</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(showid, season) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">diff =</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(airstamp, <span class="fu">lag</span>(airstamp), <span class="at">units =</span> <span class="st">"days"</span>))) </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(time_diff<span class="sc">$</span>diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]          NA   7.0000000   6.9583333   7.0104167   6.9895833  14.0000000
 [7]   7.0173611   6.9826389   7.0277778   6.9305556   7.0416667   7.0243056
[13]   6.9756944   7.0069444   6.9930556  21.0000000   7.0034722   6.9965278
[19]   6.9548611   6.9791667   7.0208333  42.0000000   7.0451389   6.9479167
[25]   7.0520833   7.0486111   6.9513889   1.0000000   6.0000000   6.0694444
[31]   1.0069444   5.9930556   5.9236111   1.0763889   5.8819444   1.0625000
[37]   6.0069444   0.9305556   0.9930556   5.0659722   7.9930556   0.9409722
[43]   6.0590278   5.9583333  84.0000000 182.0416667   7.0625000   6.9722222
[49]   7.0381944   7.0138889   6.9861111   4.0034722   0.0000000   7.5000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(time_diff, <span class="fu">aes</span>(<span class="at">x=</span>(diff))) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">100</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Difference in Episodes Airing Within Dr. Who Seasons"</span>, <span class="at">x=</span><span class="st">"Number of Days Between Release"</span>, <span class="at">y=</span><span class="st">"Count (with a log scale)"</span>) <span class="sc">+</span>   <span class="fu">scale_y_break</span>(<span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">500</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>I could not for the life of me get the single values to show up so I had to add a break to the chart.</p>
<hr>
<p>In 2-3 sentences, explain what conclusions you might draw from the data. What patterns do you notice? Are there data quality issues?</p>
<p>The most obvious conclusion is that almost all of the data points fall right at the 7 days mark. This makes sense given shows are released weekly. There are some values that fall at or near 0 which makes me think it was part 1 and 2 of the same episode being released back to back or at the same time. There’s also some pretty extreme outliers with an 80 something and 180 something. I did some research and saw that some seasons were released in two parts due to declining budgets. I don’t think there are many data quality issues, other than we don’t know why there are these breakas.</p>
</section>
</section>
<section id="timey-wimey-series-and-episodes" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Timey-Wimey Series and Episodes</h1>
<section id="setting-up" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="setting-up"><span class="header-section-number">3.1</span> Setting Up</h2>
<p>In this section of the assignment, you will work with all of the provided JSON files. Use a functional programming approach to read in all of the files and bind them together.</p>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>drwho2005 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"drwho-210.json"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">showid =</span> <span class="dv">2</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>drwho1963 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"drwho-766.json"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">showid =</span> <span class="dv">1</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>drwho2023 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"drwho-72724.json"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">showid =</span> <span class="dv">3</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>sarahjane <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"sarahjane-970.json"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">showid =</span> <span class="dv">4</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>torchwood2006 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"torchwood-659.json"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">showid =</span> <span class="dv">5</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>torchwood2011 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"torchwood-26694.json"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">showid =</span> <span class="dv">6</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>whoverse <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(drwho1963, drwho2005, drwho2023, sarahjane, torchwood2006, torchwood2011) <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>() <span class="co">#clean_names function isn't actually doing anything I don't believe</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Then, use the processing code you wrote for the previous section to perform appropriate data cleaning steps. At the end of the chunk, your data should be in a reasonably tidy, rectangular form with appropriate data types. Call this rectangular table <code>whoverse</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(whoverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     id
1 67360
2 67361
3 67362
4 67363
5 67364
6 67365
                                                                                                     url
1   https://www.tvmaze.com/episodes/67360/doctor-who-1x01-an-unearthly-child-an-unearthly-child-part-one
2   https://www.tvmaze.com/episodes/67361/doctor-who-1x02-the-cave-of-skulls-an-unearthly-child-part-two
3 https://www.tvmaze.com/episodes/67362/doctor-who-1x03-the-forest-of-fear-an-unearthly-child-part-three
4       https://www.tvmaze.com/episodes/67363/doctor-who-1x04-the-firemaker-an-unearthly-child-part-four
5              https://www.tvmaze.com/episodes/67364/doctor-who-1x05-the-dead-planet-the-daleks-part-one
6                https://www.tvmaze.com/episodes/67365/doctor-who-1x06-the-survivors-the-daleks-part-two
                                                 name season number    type
1   An Unearthly Child (An Unearthly Child, Part One)      1      1 regular
2   The Cave of Skulls (An Unearthly Child, Part Two)      1      2 regular
3 The Forest of Fear (An Unearthly Child, Part Three)      1      3 regular
4       The Firemaker (An Unearthly Child, Part Four)      1      4 regular
5              The Dead Planet (The Daleks, Part One)      1      5 regular
6                The Survivors (The Daleks, Part Two)      1      6 regular
     airdate airtime                  airstamp runtime average
1 1963-11-23   17:15 1963-11-23T17:15:00+00:00      25     8.1
2 1963-11-30   17:15 1963-11-30T17:15:00+00:00      25     7.2
3 1963-12-07   17:15 1963-12-07T17:15:00+00:00      25     7.1
4 1963-12-14   17:15 1963-12-14T17:15:00+00:00      25     7.4
5 1963-12-21   17:15 1963-12-21T17:15:00+00:00      25     7.6
6 1963-12-28   17:15 1963-12-28T17:15:00+00:00      25     7.7
                                                             image.medium
1  https://static.tvmaze.com/uploads/images/medium_landscape/22/55779.jpg
2 https://static.tvmaze.com/uploads/images/medium_landscape/50/125284.jpg
3 https://static.tvmaze.com/uploads/images/medium_landscape/50/125433.jpg
4 https://static.tvmaze.com/uploads/images/medium_landscape/50/125760.jpg
5  https://static.tvmaze.com/uploads/images/medium_landscape/22/55782.jpg
6  https://static.tvmaze.com/uploads/images/medium_landscape/22/55787.jpg
                                                             image.original
1  https://static.tvmaze.com/uploads/images/original_untouched/22/55779.jpg
2 https://static.tvmaze.com/uploads/images/original_untouched/50/125284.jpg
3 https://static.tvmaze.com/uploads/images/original_untouched/50/125433.jpg
4 https://static.tvmaze.com/uploads/images/original_untouched/50/125760.jpg
5  https://static.tvmaze.com/uploads/images/original_untouched/22/55782.jpg
6  https://static.tvmaze.com/uploads/images/original_untouched/22/55787.jpg
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     summary
1 &lt;p&gt;Barbara Wright and Ian Chesterton, two humble teachers during 1963, are surprised by a bright student named Susan Foreman. Feeling inquisitive of her upbringing, they seek out her residence to learn who nurtured such a genius. There, they discover a junkyard inhabited by her grandfather, simply known as "the Doctor", and he doesn't want them lurking about.&lt;/p&gt;&lt;p&gt;When the teachers refuse to leave, they discover that an ordinary police box is actually bigger on the inside. The Doctor decides they know too much about his and Susan's otherworldly origins and takes them on a journey across space and time in his TARDIS, the place he and Susan now call home.&lt;/p&gt;
2 &lt;p&gt;Barbara Wright and Ian Chesterton, two humble teachers during 1963, are surprised by a bright student named Susan Foreman. Feeling inquisitive of her upbringing, they seek out her residence to learn who nurtured such a genius. There, they discover a junkyard inhabited by her grandfather, simply known as "the Doctor", and he doesn't want them lurking about.&lt;/p&gt;&lt;p&gt;When the teachers refuse to leave, they discover that an ordinary police box is actually bigger on the inside. The Doctor decides they know too much about his and Susan's otherworldly origins and takes them on a journey across space and time in his TARDIS, the place he and Susan now call home.&lt;/p&gt;
3 &lt;p&gt;Barbara Wright and Ian Chesterton, two humble teachers during 1963, are surprised by a bright student named Susan Foreman. Feeling inquisitive of her upbringing, they seek out her residence to learn who nurtured such a genius. There, they discover a junkyard inhabited by her grandfather, simply known as "the Doctor", and he doesn't want them lurking about.&lt;/p&gt;&lt;p&gt;When the teachers refuse to leave, they discover that an ordinary police box is actually bigger on the inside. The Doctor decides they know too much about his and Susan's otherworldly origins and takes them on a journey across space and time in his TARDIS, the place he and Susan now call home.&lt;/p&gt;
4 &lt;p&gt;Barbara Wright and Ian Chesterton, two humble teachers during 1963, are surprised by a bright student named Susan Foreman. Feeling inquisitive of her upbringing, they seek out her residence to learn who nurtured such a genius. There, they discover a junkyard inhabited by her grandfather, simply known as "the Doctor", and he doesn't want them lurking about.&lt;/p&gt;&lt;p&gt;When the teachers refuse to leave, they discover that an ordinary police box is actually bigger on the inside. The Doctor decides they know too much about his and Susan's otherworldly origins and takes them on a journey across space and time in his TARDIS, the place he and Susan now call home.&lt;/p&gt;
5                                                                                                                                               &lt;p&gt;The TARDIS has brought the travellers to the planet Skaro where they meet two indigenous races — the Daleks, malicious mutant creatures encased in armoured travel machines, and the Thals, beautiful humanoids with pacifist principles. They convince the Thals of the need to fight for their own survival.&lt;/p&gt;&lt;p&gt;Joining forces with them and braving Skaro's many dangers, they launch a two-pronged attack on the Dalek city. The Daleks are all killed when, during the course of the fighting, their power supply is cut off.&lt;/p&gt;
6                                                                                                                                               &lt;p&gt;The TARDIS has brought the travellers to the planet Skaro where they meet two indigenous races — the Daleks, malicious mutant creatures encased in armoured travel machines, and the Thals, beautiful humanoids with pacifist principles. They convince the Thals of the need to fight for their own survival.&lt;/p&gt;&lt;p&gt;Joining forces with them and braving Skaro's many dangers, they launch a two-pronged attack on the Dalek city. The Daleks are all killed when, during the course of the fighting, their power supply is cut off.&lt;/p&gt;
                             links.href                  links.show.href
1 https://api.tvmaze.com/episodes/67360 https://api.tvmaze.com/shows/766
2 https://api.tvmaze.com/episodes/67361 https://api.tvmaze.com/shows/766
3 https://api.tvmaze.com/episodes/67362 https://api.tvmaze.com/shows/766
4 https://api.tvmaze.com/episodes/67363 https://api.tvmaze.com/shows/766
5 https://api.tvmaze.com/episodes/67364 https://api.tvmaze.com/shows/766
6 https://api.tvmaze.com/episodes/67365 https://api.tvmaze.com/shows/766
  links.show.name showid
1      Doctor Who      1
2      Doctor Who      1
3      Doctor Who      1
4      Doctor Who      1
5      Doctor Who      1
6      Doctor Who      1</code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>whoverse <span class="ot">&lt;-</span> whoverse <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest_wider</span>(image, <span class="at">names_sep =</span> <span class="st">"_"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest_wider</span>(rating, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest_wider</span>(links, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest_wider</span>(links_self, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest_wider</span>(links_show, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">airdate =</span> <span class="fu">as_date</span>(airdate)) <span class="sc">%&gt;%</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">airtime =</span> <span class="fu">hm</span>(airtime)) <span class="sc">%&gt;%</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">airstamp =</span> <span class="fu">as_datetime</span>(airstamp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `airtime = hm(airtime)`.
Caused by warning in `.parse_hms()`:
! Some strings failed to parse</code></pre>
</div>
</div>
<hr>
</section>
<section id="air-time" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="air-time"><span class="header-section-number">3.2</span> Air Time</h2>
<p>Investigate the air time of the episodes relative to the air date, series, and season. It may help to know that the <a href="https://en.wikipedia.org/wiki/Watershed_(broadcasting)">watershed</a> period in the UK is 9:00pm - 5:30am. Content that is unsuitable for minors may only be shown during this window. What conclusions do you draw about the target audience for each show?</p>
<p>How can you explain any shows in the Dr.&nbsp;Who universe which do not have airtimes provided?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>whoverse <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">hour</span>(airtime) <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">|</span> <span class="fu">hour</span>(airtime) <span class="sc">&lt;</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 18
        id url                    name  season number type  airdate    airtime  
     &lt;int&gt; &lt;chr&gt;                  &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt; &lt;date&gt;     &lt;Period&gt; 
 1  204464 https://www.tvmaze.co… Befo…      9      4 regu… 2015-10-10 21H 0M 0S
 2 2797539 https://www.tvmaze.co… Spac…      1      1 regu… 2024-05-10 0S       
 3 2797540 https://www.tvmaze.co… The …      1      2 regu… 2024-05-10 0S       
 4 2810889 https://www.tvmaze.co… Boom       1      3 regu… 2024-05-17 0S       
 5 2810890 https://www.tvmaze.co… 73 Y…      1      4 regu… 2024-05-24 0S       
 6 2810891 https://www.tvmaze.co… Dot …      1      5 regu… 2024-05-31 0S       
 7 2810892 https://www.tvmaze.co… Rogue      1      6 regu… 2024-06-07 0S       
 8 2810893 https://www.tvmaze.co… The …      1      7 regu… 2024-06-14 0S       
 9 2810894 https://www.tvmaze.co… Empi…      1      8 regu… 2024-06-21 0S       
10   58045 https://www.tvmaze.co… Ever…      1      1 regu… 2006-10-22 21H 0M 0S
# ℹ 40 more rows
# ℹ 10 more variables: airstamp &lt;dttm&gt;, runtime &lt;int&gt;, rating_average &lt;dbl&gt;,
#   image_medium &lt;chr&gt;, image_original &lt;chr&gt;, summary &lt;chr&gt;,
#   links_self_href &lt;chr&gt;, links_show_href &lt;chr&gt;, links_show_name &lt;chr&gt;,
#   showid &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>whoverse <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(airtime))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 18
       id url   name  season number type  airdate    airtime airstamp           
    &lt;int&gt; &lt;chr&gt; &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt; &lt;date&gt;     &lt;Perio&gt; &lt;dttm&gt;             
 1 1.12e6 http… Miss…      1      1 regu… 2011-07-08 NA      2011-07-08 11:00:00
 2 1.12e6 http… Miss…      1      2 regu… 2011-07-16 NA      2011-07-16 11:00:00
 3 1.12e6 http… Miss…      1      3 regu… 2011-07-23 NA      2011-07-23 11:00:00
 4 1.12e6 http… Miss…      1      4 regu… 2011-07-30 NA      2011-07-30 11:00:00
 5 1.12e6 http… Miss…      1      5 regu… 2011-08-06 NA      2011-08-06 11:00:00
 6 1.12e6 http… Miss…      1      6 regu… 2011-08-13 NA      2011-08-13 11:00:00
 7 1.12e6 http… Miss…      1      7 regu… 2011-08-20 NA      2011-08-20 11:00:00
 8 1.12e6 http… Miss…      1      8 regu… 2011-08-27 NA      2011-08-27 11:00:00
 9 1.12e6 http… Miss…      1      9 regu… 2011-09-03 NA      2011-09-03 11:00:00
10 1.12e6 http… Miss…      1     10 regu… 2011-09-10 NA      2011-09-10 11:00:00
# ℹ 9 more variables: runtime &lt;int&gt;, rating_average &lt;dbl&gt;, image_medium &lt;chr&gt;,
#   image_original &lt;chr&gt;, summary &lt;chr&gt;, links_self_href &lt;chr&gt;,
#   links_show_href &lt;chr&gt;, links_show_name &lt;chr&gt;, showid &lt;dbl&gt;</code></pre>
</div>
</div>
<p>From the tibble above, we can see that Torchwood 2006 had the most entries by far with 41. Dr.&nbsp;Who 2023 was next with 8 entries, and Dr Who 2005 had 1 episode. This tells us that Torcheed 2006 was much more aimed towards adults and was likely showing content not suitable for children. Dr.&nbsp;Who 2023 is very similar as there were only 16 episodes and half of them were shown after 9 PM. The Torchwood 2011 show does not give an airtime. This could be due to multiple airtimes based on region or due to lack of complete data. It is interesting to note, however, that the airstamp says that the episode aired at 11 AM, so it’s possible the data was not recorded correctly.</p>
</section>
<section id="another-layer-of-json" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="another-layer-of-json"><span class="header-section-number">3.3</span> Another Layer of JSON</h2>
<p>Use the show URL (<code>_links</code> &gt; <code>show</code> &gt; <code>href</code>) to read in the JSON file for each show. As with scraping, it is important to be polite and not make unnecessary server calls, so pre-process the data to ensure that you only make one server call for each show. You should use a functional programming approach when reading in these files.</p>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">unique</span>(whoverse<span class="sc">$</span>links_show_href)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>read_show <span class="ot">&lt;-</span> <span class="cf">function</span>(url) {</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">GET</span>(url)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="fu">content</span>(res, <span class="at">as =</span> <span class="st">"text"</span>), <span class="at">flatten =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">id =</span> data<span class="sc">$</span>id,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">url =</span> data<span class="sc">$</span>url,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> data<span class="sc">$</span>name,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> data<span class="sc">$</span>type,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">language =</span> data<span class="sc">$</span>language,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">genres =</span> data<span class="sc">$</span>genres,</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">status =</span> data<span class="sc">$</span>status,</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">runtime =</span> data<span class="sc">$</span>runtime,</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">averageRuntime =</span> data<span class="sc">$</span>averageRuntime,</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">premiered =</span> data<span class="sc">$</span>premiered,</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">ended =</span> data<span class="sc">$</span>ended,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">officialSite =</span> data<span class="sc">$</span>officialSite</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>shows_scraped <span class="ot">&lt;-</span> <span class="fu">map</span>(urls, read_show)</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>shows_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(shows_scraped, <span class="at">.id=</span><span class="st">"showid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Process the JSON files using a functional approach and construct an appropriate table for the combined data you’ve acquired during this step (no need to join the data with the full <code>whoverse</code> episode-level data).</p>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>null_to_na <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(x, <span class="sc">~</span> <span class="cf">if</span> (<span class="fu">is.null</span>(.x)) <span class="cn">NA</span> <span class="cf">else</span> .x)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>shows_clean <span class="ot">&lt;-</span> <span class="fu">map</span>(shows_scraped, null_to_na)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>shows_tibble <span class="ot">&lt;-</span> <span class="fu">map</span>(shows_clean, <span class="sc">~</span> <span class="fu">as_tibble</span>(.x)) </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>shows_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(shows_scraped, <span class="at">.id=</span><span class="st">"showid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>What keys would you use to join this data with the <code>whoverse</code> episode level data? Explain.</p>
<blockquote class="blockquote">
<p>I think you could use the url column and links_show_href columns as a key as they should match up. Right now, the shows_df data frame would not be easily combined with the whoverse dataset. I would maybe pivot wider and try to just combine the three different genres into one character column because I don’t think it’ll be as necessary for any analysis. Now that I’m thinking about it, I think that show_id would be the perfect key. They should be the exact same for the entries in both data frames.</p>
</blockquote>
</section>
<section id="explore" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="explore"><span class="header-section-number">3.4</span> Explore!</h2>
<p>Use the data you’ve assembled to answer a question you find interesting about this data. Any graphics you make should have appropriate titles and axis labels. Tables should be reasonably concise (e.g.&nbsp;don’t show all 900 episodes in a table), generated in a reproducible fashion, and formatted with markdown. Any results (graphics, tables, models) should be explained with at least 2-3 sentences.</p>
<p>If you’re stuck, consider examining the frequency of words in the episode descriptions across different series or seasons. Or, look at the episode guest cast by appending <code>/guestcast/</code> to the episode URL and see whether there are common guests across different seasons.</p>
<hr>
<p>How do the different series compare in terms of average runtime? How about average ratings among episodes?</p>
<hr>
<p>Code goes here – once you output a result, you should explain it using markdown text, and then start a new code chunk to continue your exploration.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>whoverse_run <span class="ot">&lt;-</span> whoverse <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(showid) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean_runtime =</span> <span class="fu">mean</span>(runtime),<span class="at">.groups=</span><span class="st">"drop"</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>whoverse_run<span class="sc">$</span>showname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"drwho1963"</span>,<span class="st">"drwho2005"</span>,<span class="st">"drwho2023"</span>,<span class="st">"sarahjane"</span>,<span class="st">"torchwood2006"</span>,<span class="st">"torchwood2011"</span>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(whoverse_run, <span class="fu">aes</span>(<span class="at">x=</span>showname, <span class="at">y=</span>(mean_runtime))) <span class="sc">+</span> <span class="fu">geom_col</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Runtime by Show"</span>, <span class="at">x=</span> <span class="st">"show"</span>, <span class="at">y =</span> <span class="st">"Runtime (minutes)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>You can see from the graph that torchwood2011 has a tiny run time of less than five minutes per episode. This means it was likely a miniseries, premiering instead of a commercial break in between episodes of other shows. Torchwood2006 on the other hand had the longest episodes on average at over 50 minutes per episode.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>whoverse_rating <span class="ot">&lt;-</span> whoverse <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(showid) <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean_rating =</span> <span class="fu">mean</span>(rating_average),<span class="at">.groups=</span><span class="st">"drop"</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>whoverse_rating<span class="sc">$</span>showname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"drwho1963"</span>,<span class="st">"drwho2005"</span>,<span class="st">"drwho2023"</span>,<span class="st">"sarahjane"</span>,<span class="st">"torchwood2006"</span>,<span class="st">"torchwood2011"</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(whoverse_rating, <span class="fu">aes</span>(<span class="at">x=</span>showname, <span class="at">y=</span>(mean_rating))) <span class="sc">+</span> <span class="fu">geom_col</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Rating by Show"</span>, <span class="at">x=</span> <span class="st">"show"</span>, <span class="at">y =</span> <span class="st">"Rating (out of 10)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here, we see yet another instance of torchwood2011 being at the bottom. With an average rating of less than 5/10, this series is critically far worse than all others. Drwho2005 to torchwood2006 all had good average ratings, while drwho1963 had a very good rating of over 8.5/10.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>